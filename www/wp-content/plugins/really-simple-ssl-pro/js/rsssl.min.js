jQuery(document).ready(function(b){var i=3000;var c=rsssl_ajax.progress;var h=b("#rsssl-scan-list").find(".progress-bar");p();var n;function p(){b("#rsssl-scan-results").DataTable({pageLength:4,info:false,language:{emptyTable:rsssl_ajax.emptyScanTable}});n=b("#rsssl-scan-results_paginate").detach();b("#rsssl-scan-pagination").append(n)}b.extend(b.fn.dataTable.defaults,{bSort:false,stateSave:true,paging:true,ordering:false,conditionalPaging:true,bAutoWidth:false,autoWidth:false,language:{search:"",sSearch:"",searchPlaceholder:rsssl_ajax.searchPlaceholder,paginate:{previous:rsssl_ajax.previous,next:rsssl_ajax.next}}});b("#rsssl-csp-table").DataTable({pageLength:4,language:{emptyTable:rsssl_ajax.emptyCspTable}});var j=b("#rsssl-permission-policy-table").DataTable({info:false,pageLength:6});b("form").on("submit",function(t){var s=b(this);j.$('input[type="radio"]').each(function(){if(!b.contains(document,this)){if(this.checked){s.append(b("<input>").attr("type","hidden").attr("name",this.name).val(this.value))}}})});h.css({width:c+"%"});q();function q(){f();window.setInterval(function(){f()},i)}b("#rsssl-permission-policy-table input:radio").click(function(){b(".rsssl-button-save").prop("disabled",false)});b(".paginate_button").click(function(){b(".rsssl-button-save").prop("disabled",false)});var d=b("#rsssl-csp-table_filter").detach();b(".rsssl-content-security-policy .rsssl-instructions").append(d);var a=b("#rsssl-csp-table_paginate").detach();b(".rsssl-content-security-policy  .rsssl-grid-item-footer").append(a);var r=b("#rsssl-csp-table_info").detach();b(".rsssl-content-security-policy  .rsssl-grid-item-footer").append('<div id="rsssl-csp-entries"></div>');b("#rsssl-csp-entries").append(r);var g=b("#rsssl-permission-policy-table_paginate").detach();b(".rsssl-permissions-policy .rsssl-grid-item-footer").append(g);var e=b("#rsssl-documentation-table_paginate").detach();b("#rsssl-documentation-pagination-placeholder").append(e);var k=b("#rsssl-scan-results_info").detach();b("#progress-page-count").append(k);b(".rsssl-advanced-settings").closest("th").css("display","block");function f(){if(c>=100){return}if(c==0){h.css({width:"1%"})}h.removeClass("progress-bar-success");b("#rsssl-scan-output").html("");b("#rsssl-scan-pagination #rsssl-scan-results_paginate").remove();b.post(rsssl_ajax.ajaxurl,{action:"get_scan_progress"},function(s){var t;if(s){t=jQuery.parseJSON(s);c=parseInt(t.progress);if(c>=100){h.html(t.action);h.css({width:c+"%"});h.addClass("progress-bar-success");b("#rsssl-scan-output").html(decodeURIComponent(t.output));p();b("#rsssl_stop_scan").hide()}else{h.html(t.action);h.css({width:c+"%"})}}})}b("body").tooltip({selector:".tooltip",placement:"bottom"});b(document).on("click","#start-fix-post",function(y){var u=b(this);var z=u.html();u.html('<div class="rsssl-loader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>');u.prop("disabled",true);var v=b(this).data("id");var A=b(this).data("path");var s=b(this).data("url");var x="fix_post";var w=b(this).data("token");var t=b(this).data("results_id");b.post(rsssl_ajax.ajaxurl,{action:x,token:w,url:s,path:A,post_id:v},function(B){u.html(z);u.prop("disabled",false);if(B.success){console.log(t);o(t);b("#fix-post-modal").modal("hide")}else{b("#fix-post-modal").find(".modal-body").prepend(B.error)}})});b(document).on("click","#start-fix-postmeta",function(y){var u=b(this);var z=u.html();u.html('<div class="rsssl-loader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>');u.prop("disabled",true);var v=b(this).data("id");var A=b(this).data("path");var s=b(this).data("url");var x="fix_postmeta";var w=b(this).data("token");var t=b(this).data("results_id");console.log(t);b.post(rsssl_ajax.ajaxurl,{action:x,token:w,url:s,path:A,post_id:v},function(B){u.html(z);u.prop("disabled",false);if(B.success){o(t);b("#fix-postmeta-modal").modal("hide")}else{b("#fix-postmeta-modal").find(".modal-body").prepend(B.error)}})});b(document).on("click","#start-fix-file",function(y){var u=b(this);var z=u.html();u.html('<div class="rsssl-loader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>');u.prop("disabled",true);var v=b(this).data("id");var A=b(this).data("path");var s=b(this).data("url");var x="fix_file";var w=b(this).data("token");var t=b(this).data("results_id");b.post(rsssl_ajax.ajaxurl,{action:x,post_id:v,token:w,url:s,path:A},function(B){u.html(z);u.prop("disabled",false);if(B.success){o(t);b("#fix-file-modal").modal("hide")}else{b("#fix-file-modal").find(".modal-body").prepend(B.error)}})});b(document).on("click","#rsssl_pro_disable_for_other_users",function(t){var s;if(b("#rsssl_pro_disable_for_other_users").is(":checked")){s="checked"}else{s="unchecked"}b.post(rsssl_ajax.ajaxurl,{action:"maybe_update_disable_license",value:s},function(u){if(u.success){}else{}})});b(document).on("click","#start-ignore-url",function(y){var u=b(this);var z=u.html();u.html('<div class="rsssl-loader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>');u.prop("disabled",true);var v=b(this).data("id");var A=b(this).data("path");var x="ignore_url";var s=b(this).data("url");var w=b(this).data("token");var t=b(this).data("results_id");b.post(rsssl_ajax.ajaxurl,{action:x,path:A,token:w,url:s,post_id:v},function(B){u.html(z);u.prop("disabled",false);if(B.success){o(t);b("#details-modal").modal("hide")}else{b("#details-modal").find(".modal-body").prepend(B.error)}})});b(document).on("click","#start-fix-widget",function(y){var v=b(this);var z=v.html();v.html('<div class="rsssl-loader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>');v.prop("disabled",true);var t=b(this).data("id");var A=b(this).data("path");var s=b(this).data("url");var x="fix_widget";var w=b(this).data("token");var u=b(this).data("results_id");b.post(rsssl_ajax.ajaxurl,{action:x,token:w,url:s,path:A,widget_id:t},function(B){v.html(z);v.prop("disabled",false);if(B.success){o(u);b("#fix-widget-modal").modal("hide")}else{b("#fix-widget-modal").find(".modal-body").prepend(B.error)}});b(this).prop("disabled",false)});b(document).on("click",".start-add-to-csp",function(){var t=b(this);var w=t.attr("data-id");var u=t.html();t.html('<div class="rsssl-loader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>');t.prop("disabled",true);var v="update_in_policy_value";var s=b(this).data("token");b.post(rsssl_ajax.ajaxurl,{action:v,token:s,id:w},function(x){t.closest("tr").remove()})});b("#fix-file-modal").on("hidden.bs.modal",function(){b("#fix-file-modal").find("#rsssl-alert").remove()});b("#fix-post-modal").on("hidden.bs.modal",function(){b("#fix-post-modal").find("#rsssl-alert").remove()});b("#fix-postmeta-modal").on("hidden.bs.modal",function(){b("#fix-postmeta-modal").find("#rsssl-alert").remove()});b("#fix-widget-modal").on("hidden.bs.modal",function(){b("#fix-widget-modal").find("#rsssl-alert").remove()});b(document).on("click","#start-roll-back",function(t){b(this).prop("disabled",true);var s=b(this).data("token");b.post(rsssl_ajax.ajaxurl,{action:"roll_back",token:s},function(u){b("#roll-back-modal").find(".modal-body").prepend(u.error)});b(this).prop("disabled",false)});b("#roll-back-modal").on("hidden.bs.modal",function(){b("#roll-back-modal").find("#rsssl-alert").remove()});b("#editor-modal").on("show.bs.modal",function(s){if(b(s.relatedTarget).data("url")=="FILE_EDIT_BLOCKED"||b(s.relatedTarget).data("url")==""){b(this).find("#edit-files-blocked").show();b(this).find("#edit-files").hide();b(this).find("#open-editor").attr("disabled",true)}else{b(this).find("#open-editor").data("url",b(s.relatedTarget).data("url"))}});b("#open-editor").click(function(s){window.location.href=b("#open-editor").data("url");b("#editor-modal").modal("hide")});b("#start-fix-cssjs").click(function(w){b(this).prop("disabled",true);var v=b(this).data("path");var t=b(this).data("url");var u=b(this).data("token");var s=b(this).data("results_id");b.post(rsssl_ajax.ajaxurl,{action:"fix_cssjs",token:u,url:t,path:v},function(x){if(x.success){o(s);b("#fix-cssjs-modal").modal("hide")}else{b("#fix-cssjs-modal").find(".modal-body").prepend(x.error)}});b(this).prop("disabled",false)});b(".rsssl-modal-dialog").on("show.bs.modal",function(s){b(this).find(".rsssl-start-action").attr("data-id",b(s.relatedTarget).data("id"));b(this).find(".rsssl-start-action").attr("data-url",b(s.relatedTarget).data("url"));b(this).find(".rsssl-start-action").attr("data-path",b(s.relatedTarget).data("path"));b(this).find(".rsssl-start-action").attr("data-results_id",b(s.relatedTarget).data("results_id"));b(this).find(".rsssl-start-action").attr("data-results_id",b(s.relatedTarget).data("results_id"))});b("#details-modal").on("show.bs.modal",function(v){var t=b(v.relatedTarget).attr("data-edit-link");if(!t){b("#edit-button").hide()}var s=b(v.relatedTarget).attr("data-help-link");if(!s){b("#help-button").hide()}var u=b(v.relatedTarget).attr("data-description");var w=b(v.relatedTarget).data("title");b("#edit-button").attr("href",t);b("#help-button").attr("href",s);b("#details-modal-description").html(u);b("#details-title").text(w)});function o(t){b("#rsssl-scan-results [data-results_id="+t+"]").closest("tr").addClass("rsssl-remove-row");var s=b("#rsssl-scan-results").DataTable();s.row(".rsssl-remove-row").remove().draw(false)}b(document).on("change","#rsssl_show_ignore_urls",function(){b("#rsssl_scan_form").append('<input type="hidden" name="rsssl_no_scan" value="rsssl_no_scan" />');b("#rsssl_scan_form").submit()});l();b(document).on("change","input[name=rsssl_hsts]",function(){l()});function l(){if(b("input[name='rsssl_hsts").is(":checked")){b('input[name="rsssl_hsts_preload"]').closest("tr").show();b(".hsts_preload_expl").show()}else{b('input[name="rsssl_hsts_preload"]').closest("tr").hide();b(".hsts_preload_expl").hide()}}m();function m(){if(b("input[name='rsssl_turn_on_permissions_policy']").is(":checked")){b("#permissions-policy-settings").closest("tr").show("slow")}else{b("#permissions-policy-settings").closest("tr").hide()}}b(document).on("change",'input[name="rsssl_turn_on_permissions_policy"]',function(){m()});b(document).on("change",'input[name="rlrsssl_options[hsts]"]',function(){l()})});